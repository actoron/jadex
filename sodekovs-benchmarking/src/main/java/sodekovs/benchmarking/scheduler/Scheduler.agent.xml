
<!-- <H3>Benchmarking Manager</H3> Responsible for generating workload /faultload 
	according to specified schedule xml file. -->

<agent xmlns="http://jadex.sourceforge.net/jadex" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jadex.sourceforge.net/jadex
	                    http://jadex.sourceforge.net/jadex-bdi-2.0.xsd"
	name="Scheduler" package="sodekovs.benchmarking.scheduler">

	<imports>				
		<import>jadex.base.fipa.*</import>
		<import>java.util.Map</import>
		<import>java.util.HashMap</import>
		<import>java.util.Random</import>
		<import>jadex.commons.*</import>
		<import>jadex.bridge.service.*</import>
		<import>jadex.commons.future.*</import>
		<import>jadex.simulation.helper.*</import>
		<import>jadex.bridge.service.types.clock.*</import>
		<import>sodekovs.benchmarking.model.*</import>
		<import>sodekovs.benchmarking.scheduler.*</import>
		<import>sodekovs.benchmarking.logger.*</import>		
	</imports>


	<capabilities>
		<!-- use capability that logs the memory consumption -->
		<capability name="memoryLoggerCap" file="sodekovs.util.logger.MemoryLogger" />
	</capabilities>



	<beliefs>

		<!-- Reference to the memory Loger Capability -->
		<belief name="MemoryLogerID" class="String">
			<fact> String.valueOf(new java.util.Random().nextInt())</fact>
			<assignto ref="memoryLoggerCap.MemoryLoggerID" />
		</belief>

		<!-- Contains all information required to execute the schedule.-->
		<belief name="SuTinfo" class="SuTinfo"/>
		
		<!-- Contains the schedule logger.-->
		<belief name="schedule_logger" class="ScheduleLogger"/>
		
		<!--Is used to scale the CRUD-operations for the components: multiplies the defined numbers with this factor. -->
		<belief name="scaleFactor" class="Double"/>

	</beliefs>

	<goals>
		<!-- Responsible for managing the start of the sequences of a benchmark 
			at the right time -->
		<achievegoal name="ScheduleSequencesGoal" retry="false"
			exclude="never">
			<!-- Contains references of the SuT. -->
			<parameter name="args" class="SuTinfo" />
		</achievegoal>

		<!-- Contains a sequence of the schedule that has to be executed many times 
			/ repeatedly. -->
		<achievegoal name="SequenceRepeaterGoal" retry="false"
			exclude="never">
			<!-- Contains references of the SuT. -->
			<parameter name="args" class="SuTinfo" />
			<!-- Sequence to be executed repeatedly. -->
			<parameter name="sequence" class="Sequence" />
			<parameter name="scheduleLogger" class="ScheduleLogger" />
		</achievegoal>
	</goals>

	<plans>		
		<!-- Start Sequence Scheduler. -->
		<plan name="start_sequences_scheduler">
			<body class="ScheduleSequencesPlan" />
			<parameter name="args" class="SuTinfo">
				<goalmapping ref="ScheduleSequencesGoal.args" />
			</parameter>
			<trigger>
				<goal ref="ScheduleSequencesGoal" />
			</trigger>
		</plan>

		<!-- Start sequence of the schedule that has to be executed many times 
			/ repeatedly. -->
		<plan name="start_sequence_repeater">
			<body class="SequenceRepeaterPlan" />
			<parameter name="args" class="SuTinfo">
				<goalmapping ref="SequenceRepeaterGoal.args" />
			</parameter>
			<parameter name="sequence" class="Sequence">
				<goalmapping ref="SequenceRepeaterGoal.sequence" />
			</parameter>
			<parameter name="scheduleLogger" class="ScheduleLogger">
				<goalmapping ref="SequenceRepeaterGoal.scheduleLogger" />
			</parameter>
			<trigger>
				<goal ref="SequenceRepeaterGoal" />
			</trigger>
		</plan>
	</plans>


	<properties>
		<!-- The environment may throw exceptions when executing property listeners 
			and these listeners are not valid any longer. This leads to normal plan failure 
			and can therefore be ignored. -->
		<property name="logging.level">java.util.logging.Level.WARNING</property>
		<property name="debugging">false</property>
		<!-- <property name="dfservice" class="IFuture">SServiceProvider.getService($scope.getServiceProvider(), 
			IDF.class, RequiredServiceInfo.SCOPE_PLATFORM)</property> -->
	</properties>

	<configurations>
		<configuration name="default">
			<goals>
				<initialgoal ref="ScheduleSequencesGoal" />
			</goals>
		</configuration>
	</configurations>
	
	<services>		
		<requiredservice name="clockservice" class="IClockService">
			<binding scope="platform" />
		</requiredservice>
	</services>

</agent>